# Penetration Testing Plan — A07 on Juice Shop

## Goals
- Identify and exploit weak authentication controls (no lockout/backoff).  
- Show practical impact (account takeover) with minimal attempts.

## Methodology (high level)
- OWASP Testing Guide (OTG-AUTHN-001/002), OWASP Top 10 A07  
- MITRE ATT&CK: T1110 (Brute Force)

## Tools
- Burp Suite Community (Proxy, Repeater, Intruder)  
- AuthProbe-JS (this repo)  
- Browser (Firefox/Chromium)

## Test Scenarios & Pass/Fail

### 1) Login brute force (`POST /rest/user/login`)
- **Steps:** capture one failed login → Intruder/PoC against `password` for known email.  
- **Pass (secure):** Multiple rapid attempts trigger 429/lockout; no success with small wordlist; alerts present.  
- **Fail (vuln):** Unlimited attempts, success with common word; no 2FA/step-up.

### 2) KBA answer brute force (Forgot Password flow)
- **Steps:** capture request carrying `"answer"`; Intruder against answer.  
- **Pass:** Throttling/step-up challenge required; backoff or temporary block.  
- **Fail:** Unlimited attempts, predictable questions/answers.

### 3) Default/weak credentials
- **Steps:** Try known defaults (`admin@juice-sh.op`/weak combos).  
- **Pass:** Defaults disabled, strong policy enforced.  
- **Fail:** Login succeeds with trivial passwords.

## Evidence Collection
- Burp HTTP history and Intruder results (screenshots)  
- AuthProbe-JS console output + CSV  
- Optional: successful token used on `/rest/user/whoami`

## Risk Rating
- Use CVSS v3.1 with realistic environmental metrics. Initial base vector example (adjust based on findings):  
  `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N`

## Remediation
- Rate-limit & lockout on auth endpoints  
- Progressive delays; CAPTCHA/step-up after N failures  
- 2FA where appropriate; avoid KBA; strong password policy  
- Monitoring & alerting for brute-force patterns
